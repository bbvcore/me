"use strict";(self.webpackChunkmydocs=self.webpackChunkmydocs||[]).push([[2315],{2429:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"Servidores/Multiplataforma/servidores-web","title":"Servidores Web con SSL","description":"Requisitos previos","source":"@site/docs/Servidores/Multiplataforma/servidores-web.md","sourceDirName":"Servidores/Multiplataforma","slug":"/Servidores/Multiplataforma/servidores-web","permalink":"/me/docs/docs/Servidores/Multiplataforma/servidores-web","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Servidores/Multiplataforma/servidores-web.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"OPNsense","permalink":"/me/docs/docs/Servidores/Linux/OPNsense"},"next":{"title":"Windows Server","permalink":"/me/docs/docs/Servidores/Windows/server-2019"}}');var s=i(4848),o=i(8453);const a={},c="Servidores Web con SSL",t={},d=[{value:"Requisitos previos",id:"requisitos-previos",level:2},{value:"Certificado autofirmado",id:"certificado-autofirmado",level:3},{value:"Configuracion Apache",id:"configuracion-apache",level:2},{value:"Host virtual",id:"host-virtual",level:3},{value:"Redireccionamiento de http a https",id:"redireccionamiento-de-http-a-https",level:3},{value:"Comandos b\xe1sicos",id:"comandos-b\xe1sicos",level:4},{value:"Configuraci\xf3n Nginx",id:"configuraci\xf3n-nginx",level:2},{value:"Certificados",id:"certificados",level:3},{value:"Configuraci\xf3n de servidor Https",id:"configuraci\xf3n-de-servidor-https",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"servidores-web-con-ssl",children:"Servidores Web con SSL"})}),"\n",(0,s.jsx)(n.h2,{id:"requisitos-previos",children:"Requisitos previos"}),"\n",(0,s.jsx)(n.h3,{id:"certificado-autofirmado",children:"Certificado autofirmado"}),"\n",(0,s.jsx)(n.p,{children:"Se ha de haber creado un certificado autofirmado y una clave privada, que ambos se almacenar\xe1n en sus correspondientes directorios en el sistema operativo."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/etc/ssl/certs\n/etc/ssl/private\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configuracion-apache",children:"Configuracion Apache"}),"\n",(0,s.jsx)(n.p,{children:"Para utilizar SSL con Apache se ha de crear un virtual host o modificar uno existente y a\xf1adir el soporte SSL al puerto 443."}),"\n",(0,s.jsx)(n.h3,{id:"host-virtual",children:"Host virtual"}),"\n",(0,s.jsx)(n.p,{children:"Su ubicaci\xf3n varia en funci\xf3n del OS, en este caso hablo desde GNU/Linux, donde su ubicaci\xf3n es la siguiente:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/etc/apache2/sites-avaliable\n"})}),"\n",(0,s.jsx)(n.p,{children:"En este directorio se crea un fichero para configurar el virtual host en el puerto 443"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo dominio-local-ssl.conf\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)(n.p,{children:"Contenido del servidor virtual"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"<VirtualHost *:443>\n    ServerName ssl.local\n    ServerAlias www.ssl.local\n    \n    DocumentRoot /var/www/html\n    \n    SSLEngine on\n    SSLCertificateFile <path>\n    SSLCertificateKeyFile <path>\n    \n    <Directory /var/www/html>\n        Options Indexes FollowSymLinks # Permite mostrar ficheros en directorio sin index y seguir enlaces simbolicos\n        AllowOverride All # Permite .htaccess para sobrescribir configuraciones\n        Require all granted # Sustituto del Allow from all\n    </Directory>\n\n    ErrorLog ${APACHE_LOG_DIR}/error.log\n    CustomLog ${APACHE_LOG_DIR}/access.log combined\n\n</VirtualHost>\n"})})]}),"\n",(0,s.jsx)(n.p,{children:"Una vez creado el fichero se procede a activarlo"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo a2ensite ssl-local.conf\n"})}),"\n",(0,s.jsx)(n.h3,{id:"redireccionamiento-de-http-a-https",children:"Redireccionamiento de http a https"}),"\n",(0,s.jsx)(n.p,{children:"Buscar el virtualhost que escucha el puerto 80 y proceder a realizar un redireccionamiento permanente"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"    ServerName tu_dominio.com\n    Redirect permanent / https://tu_dominio.com/\n"})}),"\n",(0,s.jsx)(n.h4,{id:"comandos-b\xe1sicos",children:"Comandos b\xe1sicos"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2enmod"}),":"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2ensite"}),":"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2dismod"}),":"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2dissite"}),":"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2enconf"}),":"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"a2disconf"}),":"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Los ficheros de conf se suelen solo activar o desactivar, no editar, son extras para configurar y complementar ",(0,s.jsx)(n.strong,{children:"apache2.conf"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Los comandos para los m\xf3dulos se usan solo en GNU/Linux, en Windows se activan comentando o descomentando los m\xf3dulos porque se usan l\xedneas LoadModule."}),"\n",(0,s.jsx)(n.admonition,{title:"Virtual Hosts",type:"warning",children:(0,s.jsxs)(n.p,{children:["Los ",(0,s.jsx)(n.strong,{children:"virtual host"})," en windows se suelen configurar en el fichero principal, que est\xe1 ubicado en ",(0,s.jsx)(n.strong,{children:"\\conf\\httpd.conf"}),", o tambi\xe9n en el fichero ",(0,s.jsx)(n.strong,{children:"\\conf\\extra\\httpd-vhosts.conf"})]})}),"\n",(0,s.jsx)(n.h2,{id:"configuraci\xf3n-nginx",children:"Configuraci\xf3n Nginx"}),"\n",(0,s.jsx)(n.h3,{id:"certificados",children:"Certificados"}),"\n",(0,s.jsx)(n.p,{children:"En los directorios comentados anteriormente para Apache, ya que los certificados son comunes a todos los servicios desplegados dentro del OS."}),"\n",(0,s.jsx)(n.h3,{id:"configuraci\xf3n-de-servidor-https",children:"Configuraci\xf3n de servidor Https"}),"\n",(0,s.jsx)(n.p,{children:"Se ha de editar el fichero de configuraci\xf3n"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/etc/nginx/sites-avaliable/nameDominio\n"})}),"\n",(0,s.jsx)(n.p,{children:"Y dentro de se especifican las caracter\xedsticas del servicio que se desplegara en Nginx."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"# Servidor en el puerto 80\nserver{\n    listen 80;\n    server_name: nginx.local, www.nginx.local;\n    return 301 https://$host$request_uri; # Redireccionamiento\n}\n\n# Servidor en el puerto 443\nserver{\n    listen 443 ssl;\n    server_name: nginx.local www.nginx.local;\n    \n    ssl_certificate <path>\n    ssl_certificate_key <path>\n    \n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    \n    root /var/www/<dominio_dir>;\n    index index.html index.htm;\n    \n    location / {\n        try_files $uri $uri/=404; # $uri busca file o dir, sino 404\n    }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Habilitar el servicio"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"sudo ln -s /etc/nginx/sites-available/tu_dominio /etc/nginx/sites-enabled/\nsudo nginx -t # Valida el fichero de configuraci\xf3n sin reiniciar nginx\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>c});var r=i(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);