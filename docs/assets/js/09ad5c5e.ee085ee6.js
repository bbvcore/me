"use strict";(self.webpackChunkmydocs=self.webpackChunkmydocs||[]).push([[3971],{1985:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"OT/Ciberseguridad/ElasticStack/fleet-agent","title":"Fleet y Elastic Agent","description":"Informaci\xf3n Elastic Agent","source":"@site/docs/OT/Ciberseguridad/ElasticStack/fleet-agent.md","sourceDirName":"OT/Ciberseguridad/ElasticStack","slug":"/OT/Ciberseguridad/ElasticStack/fleet-agent","permalink":"/me/docs/docs/OT/Ciberseguridad/ElasticStack/fleet-agent","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/OT/Ciberseguridad/ElasticStack/fleet-agent.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Fleet y Elastic Agent"},"sidebar":"tutorialSidebar","previous":{"title":"Elastic Serch y Kibana","permalink":"/me/docs/docs/OT/Ciberseguridad/ElasticStack/elastic-search"},"next":{"title":"Despliegue Defir","permalink":"/me/docs/docs/OT/Ciberseguridad/ElasticStack/Despliegues/despliegue-dfir"}}');var i=s(4848),r=s(8453);const l={sidebar_position:2,title:"Fleet y Elastic Agent"},t="Fleet y Elastic Agent",c={},o=[{value:"Informaci\xf3n Elastic Agent",id:"informaci\xf3n-elastic-agent",level:2},{value:"Informaci\xf3n Fleet",id:"informaci\xf3n-fleet",level:2},{value:"Estructura a lograr",id:"estructura-a-lograr",level:3},{value:"Aplicaciones pr\xe1cicas",id:"aplicaciones-pr\xe1cicas",level:2},{value:"Configuraci\xf3n e instalaci\xf3n",id:"configuraci\xf3n-e-instalaci\xf3n",level:2},{value:"Add a Fleet Server",id:"add-a-fleet-server",level:3},{value:"Instalaci\xf3n para la administraci\xf3n centralizada",id:"instalaci\xf3n-para-la-administraci\xf3n-centralizada",level:2},{value:"Posibles problemas",id:"posibles-problemas",level:3},{value:"Acceso al agente instalado",id:"acceso-al-agente-instalado",level:2},{value:"Integraciones",id:"integraciones",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:a}=n;return a||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"fleet-y-elastic-agent",children:"Fleet y Elastic Agent"})}),"\n",(0,i.jsx)(n.h2,{id:"informaci\xf3n-elastic-agent",children:"Informaci\xf3n Elastic Agent"}),"\n",(0,i.jsxs)(n.p,{children:["Los ",(0,i.jsx)(n.strong,{children:"Elastic Agents"})," son agentes ligeros en el ",(0,i.jsx)(n.strong,{children:"Stack de Elastic"})," que sustituyen a los ",(0,i.jsx)(n.strong,{children:"Beats"}),"."]}),"\n",(0,i.jsx)(n.admonition,{title:"Funciones principales",type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Recolectar datos"})," ",(0,i.jsx)(n.em,{children:"(logs, m\xe9tricas, eventos de seguridad)"}),"."]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Enviarlos a ElasticSearch/Kibana"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Ejecutar integraciones preconfiguradas"})}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"informaci\xf3n-fleet",children:"Informaci\xf3n Fleet"}),"\n",(0,i.jsxs)(n.p,{children:["Es una ",(0,i.jsx)(n.strong,{children:"herramienta centralizada"})," de ",(0,i.jsx)(n.em,{children:"Kibana"})," para gestionar agentes ",(0,i.jsx)(n.em,{children:"(Elastic Agents)"})," que recolectan datos."]}),"\n",(0,i.jsx)(n.admonition,{title:"Funciones",type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Administrar m\xfaltiples agentes de forma centralizada."}),"\n",(0,i.jsx)(n.li,{children:"Establecer las pol\xedticas de recolecci\xf3n de datos."}),"\n",(0,i.jsx)(n.li,{children:"Monitorizaci\xf3n del estado de los agentes."}),"\n"]})}),"\n",(0,i.jsx)(n.h3,{id:"estructura-a-lograr",children:"Estructura a lograr"}),"\n",(0,i.jsxs)(n.p,{children:["Para el correcto funcionamiento de ",(0,i.jsx)(n.strong,{children:"Fleet"})," se requiere lograr una estructura funcional que es la siguiente:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Host"}),": ",(0,i.jsxs)(n.em,{children:["es el ",(0,i.jsx)(n.strong,{children:"host"})," donde se crea el elastic agent."]})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agent Policy"}),": requiere de ",(0,i.jsx)(n.strong,{children:"flet server policy"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integrations"}),": aqu\xed se a\xf1aden las integraciones necesarias para la obtenci\xf3n de datos, es importante que exista la ",(0,i.jsx)(n.strong,{children:"Fleet Server"})," para lograr la funcionalidad de una administraci\xf3n centralizada de los agentes."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"aplicaciones-pr\xe1cicas",children:"Aplicaciones pr\xe1cicas"}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.p,{children:"Listado de aplicaciones pr\xe1cticas posibles"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Agentes instalados en servidores que envian m\xe9tricas del sistema"}),": ",(0,i.jsx)(n.em,{children:"RAM, uso de la CPU"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Uso de ",(0,i.jsx)(n.strong,{children:"dahsboards"})," para ver esos datos."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Centralizaci\xf3n"})," de los ",(0,i.jsx)(n.strong,{children:"logs"})," al ser indexados en elasticsearch."]}),"\n",(0,i.jsxs)(n.li,{children:["Permite ",(0,i.jsx)(n.strong,{children:"m\xfaltiples integraciones"}),"."]}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"configuraci\xf3n-e-instalaci\xf3n",children:"Configuraci\xf3n e instalaci\xf3n"}),"\n",(0,i.jsxs)(n.p,{children:["Una vez se tiene instalados tanto ",(0,i.jsx)(n.strong,{children:"ElasticSearch"})," como ",(0,i.jsx)(n.strong,{children:"Kibana"})," se procede a configurar un ",(0,i.jsx)(n.strong,{children:"Elastic agent"})," en ",(0,i.jsx)(n.strong,{children:"Fleet"}),"."]}),"\n",(0,i.jsx)(n.admonition,{title:"Acceso Kibana",type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://localhost:5601",children:"http://localhost:5601"})}),"\n"]})}),"\n",(0,i.jsxs)(n.p,{children:["Por ello, hace falta ",(0,i.jsx)(n.strong,{children:"loguearse"})," en ",(0,i.jsx)(n.strong,{children:"Kibana"})," y acceder a la siguiente ruta a trav\xe9s del men\xfa lateral accesible a trav\xe9s del icono hamburguesa."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Management > Fleet\n"})}),"\n",(0,i.jsx)(n.h3,{id:"add-a-fleet-server",children:"Add a Fleet Server"}),"\n",(0,i.jsxs)(n.p,{children:["Una vez aqu\xed se procede a ",(0,i.jsx)(n.strong,{children:"Add a Fleet Server"})," y para ello se usa la opci\xf3n ",(0,i.jsx)(n.strong,{children:"Quick Start"})," creando una pol\xedtica nueva donde se han de especificar varios datos."]}),"\n",(0,i.jsx)(n.admonition,{title:"Datos necesarios para la pol\xedtica",type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Nombre del host"}),"\n",(0,i.jsx)(n.li,{children:"URL + Puerto (8220)"}),"\n"]})}),"\n",(0,i.jsx)(n.p,{children:"Una vez creada la pol\xedtica esta ser\xe1 accesible desde la siguiente URL."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"https://localhost:8220\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Ojo al protocolo",type:"warning",children:(0,i.jsxs)(n.p,{children:["El protocolo web al espec\xedficar la m\xe1quina con el puerto ha de ser ",(0,i.jsx)(n.strong,{children:"HTTPS"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:["Siempre que est\xe9 instalado en la misma m\xe1quina que ",(0,i.jsx)(n.strong,{children:"Fleet"}),", sino habr\xeda que poner la ",(0,i.jsx)(n.strong,{children:"IP"})," de la m\xe1quina donde esta instalado ",(0,i.jsx)(n.strong,{children:"Fleet"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Una vez introducidos los datos se pulsa el bot\xf3n de ",(0,i.jsx)(n.strong,{children:"Generate"})," y se obtendr\xe1 un ",(0,i.jsx)(n.strong,{children:"Token"})," y mostrar\xe1 la configuraci\xf3n del Host y la ruta de acceso, que ser\xe1 la espec\xedficada anteriormente. Adem\xe1s se informa de que se podr\xe1n realizar ajustes en ",(0,i.jsx)(n.strong,{children:"Fleet Settings"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"instalaci\xf3n-para-la-administraci\xf3n-centralizada",children:"Instalaci\xf3n para la administraci\xf3n centralizada"}),"\n",(0,i.jsxs)(n.p,{children:["Se recomienda instalar ",(0,i.jsx)(n.em,{children:"Fleet Server"})," para ",(0,i.jsx)(n.strong,{children:"centralizar la administraci\xf3n"})," de los agentes, para ello procedemos a descargar el agente desde la shell mediante ",(0,i.jsx)(n.strong,{children:"CURL"})," apuntando a la ",(0,i.jsx)(n.strong,{children:"URL"})," ",(0,i.jsx)(n.em,{children:"artifacts.elastic.con/downloads/beats/elastic-agent"})," y una vez obtenido el tarball se ejecutan los siguientes comandos que comprenden la instalaci\xf3n del mismo a trav\xe9s del correspondiente ",(0,i.jsx)(n.strong,{children:"script"})," y con varios ",(0,i.jsx)(n.strong,{children:"argumentos"})," como ",(0,i.jsxs)(n.em,{children:["la IP",":puerto",", el token o la pol\xedtica asignada"]}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Una vez se han llevado todos estos pasos la shell pedir\xe1 la contrase\xf1a de ",(0,i.jsx)(n.strong,{children:"root"})," o del usuario con privilegios elevados para poder ",(0,i.jsx)(n.strong,{children:"instalar"})," el ",(0,i.jsx)(n.em,{children:"agente"})," de ",(0,i.jsx)(n.strong,{children:"forma local"})," en la siguiente ruta."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/opt/Elastic/Agent\n"})}),"\n",(0,i.jsx)(n.p,{children:"Una vez finalizada la instalaci\xf3n se recibe un mensaje del estado del proceso."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Elastic Agent has been succesfully installed.\n"})}),"\n",(0,i.jsx)(n.h3,{id:"posibles-problemas",children:"Posibles problemas"}),"\n",(0,i.jsx)(n.p,{children:"A veces el proceso no va tan autom\xe1tico y se queda con la obtenci\xf3n del tarball"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"tar -xzf elastic-agent-8.13.4-linux-x86_64.tar.gz\n"})}),"\n",(0,i.jsx)(n.p,{children:"Entonces se descomprime y se accede a el directorio obtenido para ejecutar la instalaci\xf3n"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo ./elastic-agent install \\\n  --url=https://<IP>:8220 \\\n  --enrollment-token=TOKEN_OBTENIDO_CON_KIBANA\n"})}),"\n",(0,i.jsx)(n.h2,{id:"acceso-al-agente-instalado",children:"Acceso al agente instalado"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"&quot;Agentes instalados&quot;",src:s(9374).A+"",width:"1363",height:"755"})}),"\n",(0,i.jsxs)(n.p,{children:["Una vez se ha instalado el agente de forma satisfactor\xeda se puede acceder a el en la secci\xf3n ",(0,i.jsx)(n.strong,{children:"Fleet > Agents"}),"."]}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsx)("summary",{children:(0,i.jsx)(n.p,{children:"Informaci\xf3n relevante sobre el agente"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status"}),": Healthy, Unhealthy, Updating, Offline, Inactive o Unenrolled."]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Host"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Pol\xedtica del Agente"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Uso de CPU"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Uso de Memor\xeda"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"\xdaltima actividad"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Versi\xf3n"})}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"integraciones",children:"Integraciones"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"&quot;Imagen con ejemplo de integraciones&quot;",src:s(2509).A+"",width:"1364",height:"675"})}),"\n",(0,i.jsxs)(n.p,{children:["Una vez establecida correctamente la instalaci\xf3n y configuraci\xf3n del agente, en la secci\xf3n ",(0,i.jsx)(n.strong,{children:"Fleet"})," de ",(0,i.jsx)(n.strong,{children:"Kibana"})," se puede comprobar el ",(0,i.jsx)(n.strong,{children:"host"})," y su correspondiente ",(0,i.jsx)(n.strong,{children:"status"})," ",(0,i.jsx)(n.em,{children:"(Healthy es el estado deseable)"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["En este caso se procede a las integraciones, por defecto es necesario tener la integraci\xf3n de ",(0,i.jsx)(n.strong,{children:"Fleet Server"})," y luego ya el resto de integraciones van en consonancia con la funcionalidad requerida y el objetivo trazado. Existen integraciones para Suricata, Nginx, MySQL, AWS, Azure, etc..."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},2509:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/fleet-server-policy-details-c1e10d71c5c2fc7d830e9a4aaeb10289.png"},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var a=s(6540);const i={},r=a.createContext(i);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),a.createElement(r.Provider,{value:n},e.children)}},9374:(e,n,s)=>{s.d(n,{A:()=>a});const a=s.p+"assets/images/fleet-2-agentes-81a72ec80ccc040c1ef4e4f115c944d8.png"}}]);