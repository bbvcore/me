<!doctype html>
<html lang="es" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Ciberseguridad/IDPS/suricata" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Suricata | MyDocs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://bbvcore.github.io/me/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://bbvcore.github.io/me/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://bbvcore.github.io/me/docs/docs/Ciberseguridad/IDPS/suricata"><meta data-rh="true" property="og:locale" content="es"><meta data-rh="true" name="docusaurus_locale" content="es"><meta data-rh="true" name="docsearch:language" content="es"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Suricata | MyDocs"><meta data-rh="true" name="description" content="&amp;#128229;Instalación"><meta data-rh="true" property="og:description" content="&amp;#128229;Instalación"><link data-rh="true" rel="icon" href="/me/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://bbvcore.github.io/me/docs/docs/Ciberseguridad/IDPS/suricata"><link data-rh="true" rel="alternate" href="https://bbvcore.github.io/me/docs/docs/Ciberseguridad/IDPS/suricata" hreflang="es"><link data-rh="true" rel="alternate" href="https://bbvcore.github.io/me/docs/docs/Ciberseguridad/IDPS/suricata" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/me/docs/blog/rss.xml" title="MyDocs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/me/docs/blog/atom.xml" title="MyDocs Atom Feed"><link rel="stylesheet" href="/me/docs/assets/css/styles.29d10b70.css">
<script src="/me/docs/assets/js/runtime~main.3aa57bf2.js" defer="defer"></script>
<script src="/me/docs/assets/js/main.cdde7228.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/me/docs/img/logo.png"><div role="region" aria-label="Saltar al contenido principal"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Saltar al contenido principal</a></div><nav aria-label="Principal" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Alternar barra lateral" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/me/docs/"><div class="navbar__logo"><img src="/me/docs/img/logo.png" alt="BBV" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/me/docs/img/logo.png" alt="BBV" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/me/docs/docs/intro">MyDocs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Cambiar entre modo oscuro y claro (actualmente modo claro)" aria-label="Cambiar entre modo oscuro y claro (actualmente modo claro)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Volver al principio" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Barra lateral de Documentos" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/me/docs/docs/intro">Documentación</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Aplicaciones/docusaurus">Aplicaciones</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/me/docs/docs/Ciberseguridad/Certificados/">Ciberseguridad</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/me/docs/docs/Ciberseguridad/Certificados/">Certificados</a><button aria-label="Ampliar la categoría &#x27;Certificados&#x27; de la barra lateral" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/me/docs/docs/Ciberseguridad/Cortafuegos/fw">Cortafuegos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/me/docs/docs/Ciberseguridad/ElasticStack/elastic-search">ElasticStack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/me/docs/docs/Ciberseguridad/IDPS/ids-ips">IDPS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/me/docs/docs/Ciberseguridad/IDPS/ids-ips">IDS/IPS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/me/docs/docs/Ciberseguridad/IDPS/open-canary">Open Canary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/me/docs/docs/Ciberseguridad/IDPS/suricata">Suricata</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/me/docs/docs/Ciberseguridad/MV/Hack-MV/">MV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/me/docs/docs/Ciberseguridad/Security Onion/intro">Security Onion</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/me/docs/docs/Ciberseguridad/VPN/openVPN">VPN</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Guía/iconos">Guía</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Linux/ip-command">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/OT/ignition">OT</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Programacion/mongodb">Programacion</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Redes/calculo-direcciones">Redes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Servicios/Contenerizacion/Docker/">Servicios</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Servidores/Linux/BIND">Servidores</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/me/docs/docs/Virtualizacion/virtual-box">Virtualizacion</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Rastro de navegación"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Página de Inicio" class="breadcrumbs__link" href="/me/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ciberseguridad</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">IDPS</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Suricata</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">En esta página</button></div><div class="theme-doc-markdown markdown"><header><h1>Suricata</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="instalación">📥Instalación<a href="#instalación" class="hash-link" aria-label="Enlace directo al 📥Instalación" title="Enlace directo al 📥Instalación">​</a></h2>
<p>La instalación, como muchas veces pasa, se puede realizar de diferentes formas, aquí se muestran las dos más habituales.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-desde-los-repositorios-de-las-distros-debianubuntu">📦 Desde los repositorios de las distros Debian/Ubuntu<a href="#-desde-los-repositorios-de-las-distros-debianubuntu" class="hash-link" aria-label="Enlace directo al 📦 Desde los repositorios de las distros Debian/Ubuntu" title="Enlace directo al 📦 Desde los repositorios de las distros Debian/Ubuntu">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install suricata -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-desde-el-repositorio-propio-de-suricata">📦 Desde el repositorio propio de Suricata<a href="#-desde-el-repositorio-propio-de-suricata" class="hash-link" aria-label="Enlace directo al 📦 Desde el repositorio propio de Suricata" title="Enlace directo al 📦 Desde el repositorio propio de Suricata">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo add-apt-repository ppa:oisf/suricata-stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install -y suricata</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Si no se dispone de <strong>add-apt-repository</strong> en la distribución se puede instalar de la siguiente forma.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install software-properties-common</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-verificar-el-resultado-de-la-instalación">✔ Verificar el resultado de la instalación<a href="#-verificar-el-resultado-de-la-instalación" class="hash-link" aria-label="Enlace directo al ✔ Verificar el resultado de la instalación" title="Enlace directo al ✔ Verificar el resultado de la instalación">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">suricata --build-info</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p><b>Resultado</b> del despligue de <b>Suricata</b></p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[✗]─[borja@parrot]─[~]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $suricata --build info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is Suricata version 6.0.10 RELEASE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Features: NFQ PCAP_SET_BUFF AF_PACKET HAVE_PACKET_FANOUT LIBCAP_NG LIBNET1.1 HAVE_HTP_URI_NORMALIZE_HOOK PCRE_JIT HAVE_NSS HAVE_LUA HAVE_LUAJIT HAVE_LIBJANSSON TLS TLS_C11 MAGIC RUST </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SIMD support: none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Atomic intrinsics: 1 2 4 8 byte(s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64-bits, Little-endian architecture</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GCC version 12.2.0, C version 201112</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">compiled with _FORTIFY_SOURCE=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1 cache line size (CLS)=64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">thread local storage method: _Thread_local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">compiled with LibHTP v0.5.42, linked against LibHTP v0.5.42</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-ficheros-importantes">📂 Ficheros importantes<a href="#-ficheros-importantes" class="hash-link" aria-label="Enlace directo al 📂 Ficheros importantes" title="Enlace directo al 📂 Ficheros importantes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-suricatayaml">📄 Suricata.yaml<a href="#-suricatayaml" class="hash-link" aria-label="Enlace directo al 📄 Suricata.yaml" title="Enlace directo al 📄 Suricata.yaml">​</a></h3>
<p>Es el archivo principal de configuración</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/suricata/suricata.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Extracto del contenido del fichero suricata.yaml</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Suricata configuration file. In addition to the comments describing all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># options in this file, full documentation can be found at:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># https://suricata.readthedocs.io/en/latest/configuration/suricata-yaml.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This configuration file generated by:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#     Suricata 6.0.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Step 1: Inform Suricata about your network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">##</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vars:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # more specific is better for alert accuracy and performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  address-groups:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HOME_NET: &quot;[192.168.0.0/16,10.0.0.0/8,172.16.0.0/12]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #HOME_NET: &quot;[192.168.0.0/16]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #HOME_NET: &quot;[10.0.0.0/8]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #HOME_NET: &quot;[172.16.0.0/12]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #HOME_NET: &quot;any&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-logs">📜 Logs<a href="#-logs" class="hash-link" aria-label="Enlace directo al 📜 Logs" title="Enlace directo al 📜 Logs">​</a></h3>
<p>Suricata tiene sus propios logs dentro del directorio habitual en GNU/Linux.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/var/log/suricata</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Principales logs</div><div class="admonitionContent_BuS1"><ul>
<li>eve.json</li>
<li>fast.log</li>
<li>stats.log</li>
<li>suricata.log</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-reglas">📖 Reglas<a href="#-reglas" class="hash-link" aria-label="Enlace directo al 📖 Reglas" title="Enlace directo al 📖 Reglas">​</a></h3>
<p>El conjunto de reglas locales</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/suricata/rules</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Aquí se pueden encontrar <strong>conjuntos de reglas</strong> <em>agrupadas</em> por tipo de <strong>protocolo</strong>, destacando algunos como: <em>dhcp-events.rules, files.rules, http2-events.rules, modbus-events.rules, mqtt-events.rules, smb-events.rules, tls-events.rules, ssh-events.rules o smtp-events.rules</em>.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Ejemplos de conjuntos de reglas para el protocolo <b>modbus</b>.</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[borja@parrot]─[/etc/suricata/rules]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $cat modbus-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Modbus Protocol version field is incorrect (Modbus version = 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus invalid Protocol version&quot;; app-layer-event:modbus.invalid_protocol_id; classtype:protocol-command-decode; sid:2250001; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Response (answer) we didn&#x27;t see a Request for. Could be packet loss.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus unsolicited response&quot;; app-layer-event:modbus.unsolicited_response; classtype:protocol-command-decode; sid:2250002; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Malformed request or response. Malformed means length field is wrong</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus invalid Length&quot;; app-layer-event:modbus.invalid_length; classtype:protocol-command-decode; sid:2250003; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Unit identifier field is incorrect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus invalid Unit Identifier&quot;; app-layer-event:modbus.invalid_unit_identifier; classtype:protocol-command-decode; sid:2250004; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Modbus Function code is incorrect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus invalid Function code&quot;; app-layer-event:modbus.invalid_function_code; classtype:protocol-command-decode; sid:2250005; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Modbus Request/Response value field is incorrect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus invalid Value&quot;; app-layer-event:modbus.invalid_value; classtype:protocol-command-decode; sid:2250006; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Modbus Expception code is incorrect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus Exception code invalid&quot;; flow:to_client; app-layer-event:modbus.invalid_exception_code; classtype:protocol-command-decode; sid:2250007; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Value field in Modbus Response does not match with Modbus Request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus Data mismatch&quot;; flow:to_client; app-layer-event:modbus.value_mismatch; classtype:protocol-command-decode; sid:2250008; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Request Flood Detected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert modbus any any -&gt; any any (msg:&quot;SURICATA Modbus Request flood detected&quot;; flow:to_server; app-layer-event:modbus.flooded; classtype:protocol-command-decode; sid:2250009; rev:2;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>SID</div><div class="admonitionContent_BuS1"><p>Las reglas personalizadas añadidas han de tener un SID &gt; 1.000.000</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-suricata-update">🔁 Suricata-update<a href="#-suricata-update" class="hash-link" aria-label="Enlace directo al 🔁 Suricata-update" title="Enlace directo al 🔁 Suricata-update">​</a></h3>
<p>Es el fichero de configuración para <strong>suricata-update</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/etc/suricata/update.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-ejecución-como-ids">🛡 Ejecución como IDS<a href="#-ejecución-como-ids" class="hash-link" aria-label="Enlace directo al 🛡 Ejecución como IDS" title="Enlace directo al 🛡 Ejecución como IDS">​</a></h2>
<p>Remplazar la interfaz por el nombre correspondiente de la interfaz escogida.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo suricata -c /etc/suricata/suricata.yaml -i eth0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Lanzamiento de <b>Suricata</b> sin especificar reglas</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[borja@parrot]─[/etc/suricata/rules]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $sudo suricata -c /etc/suricata/suricata.yaml -i wlx3c52a1c35918</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[sudo] contraseña para trabajo: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 11:40:42 - &lt;Notice&gt; - This is Suricata version 6.0.10 RELEASE running in SYSTEM mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 11:40:42 - &lt;Warning&gt; - [ERRCODE: SC_ERR_NO_RULES(42)] - No rule files match the pattern /etc/suricata/rules/suricata.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 11:40:42 - &lt;Warning&gt; - [ERRCODE: SC_ERR_NO_RULES_LOADED(43)] - 1 rule files specified, but no rules were loaded!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 11:40:42 - &lt;Notice&gt; - all 12 packet processing threads, 4 management threads initialized, engine started.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<p>Existen reglas pero no las cargó <strong>Suricata</strong> por ello se ha de revisar la configuración del fichero <strong>yaml</strong>, y comprobar en la sección <strong>rule-files</strong> que apuntan correctamente al destino.</p>
<p>Entonces en la sección mencionada se añaden todas las reglas que existan en el directorio <strong>/etc/suricata/rules</strong></p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Contenido de la sección de rule-files</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rule-files:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - app-layer-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - dns-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ipsec-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - nfs-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ssh-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - decoder-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - files.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - kerberos-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - ntp-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - stream-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - dhcp-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - http2-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - modbus-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - smb-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - tls-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - dnp3-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - http-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - mqtt-events.rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - smtp-events.rules</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Comprobar la ruta en suricata.yaml</div><div class="admonitionContent_BuS1"><p>Comprobar en el fichero de configuración <strong>suricata.yaml</strong> la ruta por defecto de las reglas, ya que puede no ser <strong>/etc/suricata/rules</strong>. La variable a buscar en el fichero es <strong>default-rule-path</strong>.</p></div></div>
<p>A continuación se reinicia <strong>Suricata</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart suricata</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>aviso</div><div class="admonitionContent_BuS1"><p>Por defecto los módulos <strong>http2</strong>, <strong>modbus</strong> y <strong>dnp3</strong> vienen como <em>&quot;enable<!-- -->:no<!-- -->&quot;</em> y hay que ponerlos a <em>&quot;enable<!-- -->:yes<!-- -->&quot;</em> para que <strong>Suricata</strong> arranque bien.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-test-de-funcionamiento">→ Test de funcionamiento<a href="#-test-de-funcionamiento" class="hash-link" aria-label="Enlace directo al → Test de funcionamiento" title="Enlace directo al → Test de funcionamiento">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[✗]─[borjao@parrot]─[/etc/suricata/rules]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $sudo suricata -T -c /etc/suricata/suricata.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[sudo] contraseña para borja: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 12:23:23 - &lt;Info&gt; - Running suricata under test mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 12:23:23 - &lt;Notice&gt; - This is Suricata version 6.0.10 RELEASE running in SYSTEM mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 12:23:23 - &lt;Notice&gt; - Configuration provided was successfully loaded. Exiting.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-funcionamiento-correcto">→ Funcionamiento correcto<a href="#-funcionamiento-correcto" class="hash-link" aria-label="Enlace directo al → Funcionamiento correcto" title="Enlace directo al → Funcionamiento correcto">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[borja@parrot]─[/etc/suricata/rules]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $sudo suricata -c /etc/suricata/suricata.yaml -i wlx3c52a1c35918</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[sudo] contraseña para trabajo: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 12:26:33 - &lt;Notice&gt; - This is Suricata version 6.0.10 RELEASE running in SYSTEM mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14/4/2025 -- 12:26:33 - &lt;Notice&gt; - all 12 packet processing threads, 4 management threads initialized, engine started.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-regas-emerging-threats">📝 Regas Emerging Threats<a href="#-regas-emerging-threats" class="hash-link" aria-label="Enlace directo al 📝 Regas Emerging Threats" title="Enlace directo al 📝 Regas Emerging Threats">​</a></h2>
<p>Un conjunto de reglas rápidas de añadir a Suricata desarrolladas por la comunidad de <strong>Emerging Threats</strong>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install suricata-update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo suricata-update</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-ver-alertas">🔔 Ver alertas<a href="#-ver-alertas" class="hash-link" aria-label="Enlace directo al 🔔 Ver alertas" title="Enlace directo al 🔔 Ver alertas">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo tail -f /var/log/suricata/fast.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-comprobaciones">✅ Comprobaciones<a href="#-comprobaciones" class="hash-link" aria-label="Enlace directo al ✅ Comprobaciones" title="Enlace directo al ✅ Comprobaciones">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-ejecución-en-primer-plano">→ Ejecución en primer plano<a href="#-ejecución-en-primer-plano" class="hash-link" aria-label="Enlace directo al → Ejecución en primer plano" title="Enlace directo al → Ejecución en primer plano">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo suricata -c /etc/suricata/suricata.yaml -i eth10 --init-errors-fatal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>nota</div><div class="admonitionContent_BuS1"><ul>
<li><strong>c</strong>: indica el path del fichero de configuración</li>
<li><strong>i</strong>: configura la interfaz en la que va a escuchar</li>
<li><strong>--init-errors-fatal</strong>: muestra los errores fatales en el lanzamiento de Suricata.</li>
</ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-simular-tráfico-malicioso">→ Simular tráfico malicioso<a href="#-simular-tráfico-malicioso" class="hash-link" aria-label="Enlace directo al → Simular tráfico malicioso" title="Enlace directo al → Simular tráfico malicioso">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl http://testmyids.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Web de pruebas</div><div class="admonitionContent_BuS1"><p>La <strong>URL</strong> <em>testmyids.com</em> sirve para probar si el IDS/IPS está bien configurado, en este caso simula respuesta del comando &quot;id&quot; con lo cuál parece haber tenido éxito una vulnerabilidad y debería de mostrar una alerta el IDS/IPS.</p></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-leer-logs">→ Leer logs<a href="#-leer-logs" class="hash-link" aria-label="Enlace directo al → Leer logs" title="Enlace directo al → Leer logs">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tail -f /var/log/suricata/fast.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>nota</div><div class="admonitionContent_BuS1"><ul>
<li><strong>f</strong>: sigue al descriptor del fichero, aunque se renombre el fichero.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-inspeccionar-evejson">🔍 Inspeccionar eve.json<a href="#-inspeccionar-evejson" class="hash-link" aria-label="Enlace directo al 🔍 Inspeccionar eve.json" title="Enlace directo al 🔍 Inspeccionar eve.json">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-jq">🔩 JQ<a href="#-jq" class="hash-link" aria-label="Enlace directo al 🔩 JQ" title="Enlace directo al 🔩 JQ">​</a></h4>
<p><strong>JQ</strong> sirve para procesar JSON y llevar a cabo varias operaciones, como el embellecimiento de los datos.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Embellece tu JSON</div><div class="admonitionContent_BuS1"><p>-<a href="https://jqlang.org/">Enbellecedor JSON</a></p></div></div>
<p>Si no se encuentra instalado en el equipo es posible instalarlo de la siguiente forma en equipos Linux.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Un buen ejemplo para comprobar la legibilidad que ofrece esta utilidad es ejecutar los siguientes comandos desde una terminal y apreciar las enormes diferencias.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat eve.json # Se verá un stream de datos dificilmente seguible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jq . eve.json # Se mostrará una sucesión de objetos JSON legibles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-evejson">🔖 Eve.JSON<a href="#-evejson" class="hash-link" aria-label="Enlace directo al 🔖 Eve.JSON" title="Enlace directo al 🔖 Eve.JSON">​</a></h4>
<p>Fichero principal que genera Suricata en formato JSON, en este fichero se pueden consultar los siguientes eventos:</p>
<ul>
<li><strong>Alertas</strong>: consultando el tipo de evento de alerta, <strong>&quot;event_type&quot;:&quot;alert&quot;</strong>.</li>
<li><strong>Comprobar las conexiones de red</strong>: a través del tipo de evento flujo,  <strong>&quot;event_type&quot;:&quot;flow&quot;</strong>.</li>
<li>Posibilita el análisis de protocolos como SSH, HTTP, TLS...</li>
<li>Información sobre archivos detectados.</li>
<li>Información sobre los protocolos detectados.</li>
<li>Consulta de los Logs.</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jq . /var/log/suricata/eve.json | less</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Este fichero <strong>eve.json</strong> es la base de <strong>Suricata</strong> para trabajar con varios sistemas como <strong>ELK</strong> o <strong>Grafana</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-crear-reglas-propias-en-suricata">🔧 Crear reglas propias en Suricata<a href="#-crear-reglas-propias-en-suricata" class="hash-link" aria-label="Enlace directo al 🔧 Crear reglas propias en Suricata" title="Enlace directo al 🔧 Crear reglas propias en Suricata">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-reglas-http">📐 Reglas HTTP<a href="#-reglas-http" class="hash-link" aria-label="Enlace directo al 📐 Reglas HTTP" title="Enlace directo al 📐 Reglas HTTP">​</a></h3>
<p>Las reglas en suricata siguen una estructura determinada que es la siguiente:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">acción protocolo src_ip src_port -&gt; dst_ip dst_port (opciones)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Parámetros de las reglas</div><div class="admonitionContent_BuS1"><ul>
<li><strong>acción</strong>: detectar un evento <em>(alert, drop o reject)</em></li>
<li><strong>protocolo</strong>: el protocolo correspondiente <em>(http, udp, icmp)</em></li>
<li><strong>src_ip</strong>: ip de origen</li>
<li><strong>src_port</strong>: puerto de origen</li>
<li><strong>dst_ip</strong>: ip de destino</li>
<li><strong>dst_port</strong>: puerto de destino</li>
<li><strong>opciones</strong>: opciones varias como mensajes, información adicional, etc...</li>
</ul></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Listado de características más utilizadas en <b>HTTP</b></p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;msg:text&quot; texto del mensaje </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;sid: number&quot;: ID único de las reglas, para personalizadas superior a 1000000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;classtype:type&quot;: tipo aplicación</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;rev:value&quot; versión de la regla, incrementa con las ediciones</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;flow: to_server, established&quot;: paquete hacía el servidor, conexión establecida</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;flow: to_client, established&quot;: paquete hacía el cliente, conexión establecida</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;flow: established&quot;, solo conexiones establecidas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;http.method&quot;: método </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;http.uri&quot;: ruta del recurso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;http.host&quot;: nombre del dominio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;http.user_agent&quot;: el agente (curl, mozilla)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;http.request_line&quot;: línea de la petición (VerboHTTP /url HTTP/version)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;content:cadena&quot;: una cadena literal a buscar:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. &#x27;nocase&#x27;: no case sensitive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. &#x27;offset:x;&#x27;: rangos de búsqueda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. &#x27;depth:y;&#x27;: rangos de búsqueda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &#x27;pcre:&quot;/expr/&quot; : expresiones regulares tipo PCRE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &#x27;threshold:type limit, track by_src, count number, seconds number&#x27; alerta por IP cada X tiempo.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-regla-para-peticiones-http">→ Regla para peticiones HTTP<a href="#-regla-para-peticiones-http" class="hash-link" aria-label="Enlace directo al → Regla para peticiones HTTP" title="Enlace directo al → Regla para peticiones HTTP">​</a></h4>
<p>Establecimiento de una regla propia básica de Suricata para comprobar cualquier tipo de petición HTTP que se produzca.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alert http any any -&gt; any any (msg:&quot;HTTP GET Request Detected&quot;; flow:to_server,established; http.method; content:&quot;GET&quot;; classtype:web-application-activity; sid:1000001; rev:1;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Explicación de la estrutura de la regla aplicada.</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;Tipo de acción&lt;/b&gt;: alert, se notifica una alerta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;Protocolo&lt;/b&gt;: http.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;any&lt;/b&gt;: cualquier IP origen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;any&lt;/b&gt;: cualquier PORT origen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;any&lt;/b&gt;: cualquier IP destino</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;any&lt;/b&gt;: cualquier PORT destino</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;()&lt;/b&gt;: incluye las opciones. Condiciones ESTRICTAS para que la alerta se dispare.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Explicación de las opciones.</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;msg&lt;/b&gt;: mensaje que aparecerá en el LOG cuando la regla se dispare.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;flow&lt;/b&gt;: to_server, stablished: flujo de datos, paquete de cliente a servidor  y conexión establecida.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;http.method&lt;/b&gt;: se indica la búsqueda en el campo http.method.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;content&lt;/b&gt;:&quot;get&quot;, busca GET en la cabecera HTTP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;classtype&lt;/b&gt;:web-application-activity: clasifica la alerta en la categoría correspondiente.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;SID&lt;/b&gt;: idnetificador único de la regla</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &lt;b&gt;rev1&lt;/b&gt;: versión de la regla, cada vez que se cambié la regla se debe de incrementar.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-comprobación-del-funcionamiento-de-la-regla">→ Comprobación del funcionamiento de la regla<a href="#-comprobación-del-funcionamiento-de-la-regla" class="hash-link" aria-label="Enlace directo al → Comprobación del funcionamiento de la regla" title="Enlace directo al → Comprobación del funcionamiento de la regla">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo tail -f /var/log/suricata/fast.log </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">04/16/2025-09:35:55.545375  [**] [1:1000001:1] HTTP GET Request Detected [**] [Classification: access to a potentially vulnerable web application] [Priority: 2] {TCP} 10.0.2.15:52994 -&gt; 193.110.128.199:80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="-regla-para-respuestas-http">→ Regla para respuestas HTTP<a href="#-regla-para-respuestas-http" class="hash-link" aria-label="Enlace directo al → Regla para respuestas HTTP" title="Enlace directo al → Regla para respuestas HTTP">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">alert http any any -&gt; any any (msg:&quot;HTTP 200 OK Response Detected&quot;; flow:to_client,established; http.response_line; content:&quot;200 OK&quot;; classtype:successful-user; sid:1000002; rev:1;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-anexo-redes-comando-ip">🌐 Anexo redes [comando ip]<a href="#-anexo-redes-comando-ip" class="hash-link" aria-label="Enlace directo al 🌐 Anexo redes [comando ip]" title="Enlace directo al 🌐 Anexo redes [comando ip]">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-comprobaciones-de-namespaces-espacios-de-red">✅ Comprobaciones de namespaces (espacios de red)<a href="#-comprobaciones-de-namespaces-espacios-de-red" class="hash-link" aria-label="Enlace directo al ✅ Comprobaciones de namespaces (espacios de red)" title="Enlace directo al ✅ Comprobaciones de namespaces (espacios de red)">​</a></h3>
<p>Obtener el <strong>UUID</strong> con el parámetro <strong>netns</strong> que sirve para averiguar un <strong>network namespace</strong> <em>(espacio de red aislado, como en la contenerización)</em>, entonces desde un host se puede interaccionar con estos espacios.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip netns list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ver información de dicho <strong>UUID</strong>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip netns exec netns-35c7edf0-709c-0cb3-7bd1-216a73b9a29e ip a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Parámetros netns usados</div><div class="admonitionContent_BuS1"><ul>
<li><strong>ip netns exec</strong>, comando a ejecutar en un espacio de red.</li>
<li><strong>netns-...</strong>, identificador del nombre del espacio.</li>
<li><strong>ip a</strong>, el comando a ejecutar dentro del espacio de red.</li>
</ul></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><p>Resultado de la consulta</p></summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[borja@parrot]─[/etc/suricata]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $sudo ip netns exec netns-35c7edf0-709c-0cb3-7bd1-216a73b9a29e ip a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 127.0.0.1/8 scope host lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 ::1/128 scope host proto kernel_lo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2: eth0@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    link/ether 6e:8f:28:bf:5d:4e brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet 10.89.0.2/24 brd 10.89.0.255 scope global eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inet6 fe80::6c8f:28ff:febf:5d4e/64 scope link proto kernel_ll </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       valid_lft forever preferred_lft forever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copiar código" title="Copiar" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Ciberseguridad/IDPS/suricata.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Editar esta página</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Página del documento"><a class="pagination-nav__link pagination-nav__link--prev" href="/me/docs/docs/Ciberseguridad/IDPS/open-canary"><div class="pagination-nav__sublabel">Anterior</div><div class="pagination-nav__label">Open Canary</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/me/docs/docs/Ciberseguridad/MV/Hack-MV/"><div class="pagination-nav__sublabel">Siguiente</div><div class="pagination-nav__label">Hack MV</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#instalación" class="table-of-contents__link toc-highlight">📥Instalación</a><ul><li><a href="#-desde-los-repositorios-de-las-distros-debianubuntu" class="table-of-contents__link toc-highlight">📦 Desde los repositorios de las distros Debian/Ubuntu</a></li><li><a href="#-desde-el-repositorio-propio-de-suricata" class="table-of-contents__link toc-highlight">📦 Desde el repositorio propio de Suricata</a></li><li><a href="#-verificar-el-resultado-de-la-instalación" class="table-of-contents__link toc-highlight">✔ Verificar el resultado de la instalación</a></li></ul></li><li><a href="#-ficheros-importantes" class="table-of-contents__link toc-highlight">📂 Ficheros importantes</a><ul><li><a href="#-suricatayaml" class="table-of-contents__link toc-highlight">📄 Suricata.yaml</a></li><li><a href="#-logs" class="table-of-contents__link toc-highlight">📜 Logs</a></li><li><a href="#-reglas" class="table-of-contents__link toc-highlight">📖 Reglas</a></li><li><a href="#-suricata-update" class="table-of-contents__link toc-highlight">🔁 Suricata-update</a></li></ul></li><li><a href="#-ejecución-como-ids" class="table-of-contents__link toc-highlight">🛡 Ejecución como IDS</a><ul><li><a href="#-test-de-funcionamiento" class="table-of-contents__link toc-highlight">→ Test de funcionamiento</a></li><li><a href="#-funcionamiento-correcto" class="table-of-contents__link toc-highlight">→ Funcionamiento correcto</a></li></ul></li><li><a href="#-regas-emerging-threats" class="table-of-contents__link toc-highlight">📝 Regas Emerging Threats</a></li><li><a href="#-ver-alertas" class="table-of-contents__link toc-highlight">🔔 Ver alertas</a></li><li><a href="#-comprobaciones" class="table-of-contents__link toc-highlight">✅ Comprobaciones</a><ul><li><a href="#-ejecución-en-primer-plano" class="table-of-contents__link toc-highlight">→ Ejecución en primer plano</a></li><li><a href="#-simular-tráfico-malicioso" class="table-of-contents__link toc-highlight">→ Simular tráfico malicioso</a></li><li><a href="#-leer-logs" class="table-of-contents__link toc-highlight">→ Leer logs</a></li><li><a href="#-inspeccionar-evejson" class="table-of-contents__link toc-highlight">🔍 Inspeccionar eve.json</a></li></ul></li><li><a href="#-crear-reglas-propias-en-suricata" class="table-of-contents__link toc-highlight">🔧 Crear reglas propias en Suricata</a><ul><li><a href="#-reglas-http" class="table-of-contents__link toc-highlight">📐 Reglas HTTP</a></li></ul></li><li><a href="#-anexo-redes-comando-ip" class="table-of-contents__link toc-highlight">🌐 Anexo redes [comando ip]</a><ul><li><a href="#-comprobaciones-de-namespaces-espacios-de-red" class="table-of-contents__link toc-highlight">✅ Comprobaciones de namespaces (espacios de red)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/me/docs/docs/intro">MyDocs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Sobre mí</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bio<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Repositorio<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Borja Bas Ventín.</div></div></div></footer></div>
</body>
</html>